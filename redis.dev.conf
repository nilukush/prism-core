# Redis configuration for local development
# Optimized for developer experience with persistence

# Simple password for development
requirepass redis_dev

# Network settings
bind 0.0.0.0
protected-mode yes
port 6379
tcp-backlog 511
timeout 0
tcp-keepalive 300

# Persistence - More aggressive for development
# Save after 60 seconds if at least 1 key changed
save 60 1
# Save after 30 seconds if at least 10 keys changed
save 30 10
# Save after 10 seconds if at least 100 keys changed
save 10 100

# Don't stop on errors in dev
stop-writes-on-bgsave-error no
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb
dir /data

# AOF for development - fsync every second
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
# Smaller for dev
auto-aof-rewrite-min-size 1mb
aof-load-truncated yes
aof-use-rdb-preamble yes

# Memory - smaller limits for local development
maxmemory 256mb
maxmemory-policy allkeys-lru

# Logging - verbose for development
loglevel debug
logfile ""

# Slow log - more aggressive for development
# 1ms threshold
slowlog-log-slower-than 1000
slowlog-max-len 500

# Event notification for session debugging
# All events for debugging
notify-keyspace-events AKE

# Development-friendly settings
latency-monitor-threshold 100
# More responsive for development
hz 100

# Client limits - relaxed for development
maxclients 10000
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# Development monitoring
# Enable all commands (including dangerous ones) for debugging
# rename-command FLUSHDB ""
# rename-command FLUSHALL ""
# rename-command CONFIG ""